<!DOCTYPE html>
<html>
	<head>
		<title>Live2D</title>
		<link rel="stylesheet" href="../style/index.css">
	</head>
	<body style="position: relative;">
		<canvas id="canvas" onclick="animation()"></canvas>
		<div class="canvas-bg"></div>
		<div class="loading" id="loading">
			<img src="../images/icon/loading.webp">
		</div>
	</body>
</html>
<script>
	const deviceMatch = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i) || [] // eslint-disable-line
	var isMobile = !!deviceMatch[0]
</script>
<script src='../libs/live2d.min.js'></script>
<script src='../js/Live2DFramework.js'></script>
<script src='../js/PlatformManager.js'></script>
<script src='../js/ModelSettingJson.js'></script>
<script src='../js/destinychild.2d.js'></script>
<!-- <script src="../script/getCanvas.js"></script> -->
<script>
	const searchParams = (new URL(window.location.href)).searchParams
	const code = searchParams.get('code') || ''

	let initPanzoom = localStorage.getItem(`${code}_panzoom`)

	if (initPanzoom) {
		initPanzoom = JSON.parse(initPanzoom)
	} else {
		initPanzoom = {}
	}

	const { x = 0, y = 0, scale = 0.5 } = initPanzoom

	initModel(code, scale, x, y)

	document.addEventListener('keydown', function(e) {
		if (e.keyCode == 27) {
			parent.App.config.globalProperties.$closeIframe()
		}
	})
</script>
